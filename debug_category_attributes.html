<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Category Attributes</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .debug-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; }
        .error { color: red; }
        .success { color: green; }
        .info { color: blue; }
        select { padding: 5px; margin: 10px; }
        button { padding: 10px 15px; margin: 5px; }
    </style>
</head>
<body>
    <h1>Debug Category Attributes Loading</h1>
    
    <div class="debug-section">
        <h3>Test Category Selection</h3>
        <label for="categorySelect">Select Category:</label>
        <select id="categorySelect">
            <option value="">-- Select Category --</option>
            <option value="1027">Ø³Ø§Ø¹Øª Ù…Ø±Ø¯Ø§Ù†Ù‡</option>
            <option value="1036">ØªÛŒ Ø´Ø±Øª</option>
            <option value="1039">Ø³Ø§Ø¹Øª Ø²Ù†Ø§Ù†Ù‡</option>
            <option value="1031">Ø§Ú©Ø³Ø³ÙˆØ±ÛŒ Ù…Ø±Ø¯Ø§Ù†Ù‡</option>
        </select>
        <button onclick="testLoadAttributes()">Test Load Attributes</button>
        <button onclick="debugWindowData()">Debug Window Data</button>
    </div>
    
    <div class="debug-section">
        <h3>Debug Output</h3>
        <div id="debugOutput"></div>
    </div>
    
    <div class="debug-section">
        <h3>Category Attributes Data</h3>
        <div id="categoryAttributesData"></div>
    </div>

    <script>
        // Simulate the category attributes data structure from the backend
        window.categoryAttributes = {
            "1027": [
                {
                    "key": "brand",
                    "required": true,
                    "type": "select",
                    "value": "",
                    "source": "legacy",
                    "values": ["Ø±ÙˆÙ„Ú©Ø³", "Ø§Ù…Ú¯Ø§", "Ú©Ø§Ø±ØªÛŒÙ‡", "Ù„ÙˆÙ†Ú˜ÛŒÙ†", "Ù‡Ù…ÛŒÙ„ØªÙˆÙ†", "Ø§ÙØ±ÛŒØ³", "ØªÙˆØ¯ÙˆØ±", "ØªÚ¯ Ù‡ÙˆÛŒØ±", "ÙØ±Ø¯Ø±ÛŒÚ© Ú©Ù†Ø³ØªØ§Ù†Øª", "Ø³ÛŒÚ©Ùˆ", "Ù¾ØªÚ© ÙÛŒÙ„ÛŒÙ¾", "ÙˆØ´Ø±ÙˆÙ† Ú©Ù†Ø³ØªØ§Ù†ØªÛŒÙ†", "Ø³Ø±ØªÛŒÙ†Ø§", "ØªÛŒØ³Ùˆ", "Ø§ÙˆØ±ÛŒÙ†Øª", "Ø³ÙˆØ§Ú†"]
                },
                {
                    "key": "body_material",
                    "required": true,
                    "type": "select",
                    "value": "",
                    "source": "legacy",
                    "values": ["Ø§Ø³ØªÛŒÙ„", "Ø³Ø±Ø§Ù…ÛŒÚ©", "ØªÛŒØªØ§Ù†ÛŒÙˆÙ…", "Ø·Ù„Ø§ÛŒ 18 Ø¹ÛŒØ§Ø±"]
                },
                {
                    "key": "strap_material",
                    "required": false,
                    "type": "select",
                    "value": "",
                    "source": "legacy",
                    "values": ["Ø¨Ø±ÛŒØ³Ù„Øª", "Ø¬ÙˆØ¨ÛŒÙ„ÛŒ", "Ø±Ø§Ø¨Ø±", "Ù†ÛŒØªÙˆ", "Ú†Ø±Ù… Ø·Ø¨ÛŒØ¹ÛŒ", "Ú†Ø±Ù… Ù…ØµÙ†ÙˆØ¹ÛŒ"]
                }
            ],
            "1036": [
                {
                    "key": "size",
                    "required": true,
                    "type": "select",
                    "value": "",
                    "source": "legacy",
                    "values": ["S", "M", "L", "XL", "XXL", "XXXL", "XS"]
                },
                {
                    "key": "material",
                    "required": true,
                    "type": "select",
                    "value": "",
                    "source": "legacy",
                    "values": ["ØªØ±ÛŒâ€ŒØ¨Ù„Ù†Ø¯", "ØªØ±ÛŒâ€ŒØ¨Ù„Ù†Ø¯ Ùˆ Ù¾Ù„ÛŒâ€ŒØ§Ø³ØªØ±", "ØªØ±ÛŒâ€ŒØ¨Ù„Ù†Ø¯ Ùˆ Ù¾Ù†Ø¨Ù‡", "Ù¾Ù„ÛŒâ€ŒØ§Ø³ØªØ± 100%", "Ù¾Ù„ÛŒâ€ŒØ§Ø³ØªØ± Ùˆ Ø§Ù„Ø§Ø³ØªÛŒÙ†", "Ù¾Ù„ÛŒâ€ŒØ§Ø³ØªØ± Ùˆ Ø±ÛŒÙˆÙ†", "Ù¾Ù„ÛŒâ€ŒØ§Ø³ØªØ± Ùˆ Ù†Ø§ÛŒÙ„ÙˆÙ†", "Ù¾Ù„ÛŒâ€ŒØ§Ø³ØªØ± Ùˆ ÙˆÛŒØ³Ú©ÙˆØ²", "Ù¾Ù†Ø¨Ù‡ 100%", "Ù¾Ù†Ø¨Ù‡ 50% Ùˆ Ù¾Ù„ÛŒâ€ŒØ§Ø³ØªØ± 50%", "Ù¾Ù†Ø¨Ù‡ 60% Ùˆ Ù¾Ù„ÛŒâ€ŒØ§Ø³ØªØ± 40%", "Ù¾Ù†Ø¨Ù‡ 70% Ùˆ Ù¾Ù„ÛŒâ€ŒØ§Ø³ØªØ± 30%", "Ù¾Ù†Ø¨Ù‡ 80% Ùˆ Ù¾Ù„ÛŒâ€ŒØ§Ø³ØªØ± 20%", "Ù¾Ù†Ø¨Ù‡ 95% Ùˆ Ø§Ù„Ø§Ø³ØªÛŒÙ† 5%", "Ù¾Ù†Ø¨Ù‡ Ø§Ø±Ú¯Ø§Ù†ÛŒÚ©", "Ù¾Ù†Ø¨Ù‡ Ø¨Ø§ Ù¾ÙˆØ´Ø´ Ø¶Ø¯ UV", "Ù¾Ù†Ø¨Ù‡ Ø¨Ø§ Ù¾ÙˆØ´Ø´ Ø¶Ø¯ Ø¨Ø§Ú©ØªØ±ÛŒ", "Ù¾Ù†Ø¨Ù‡ Ø¨Ø§ Ù¾ÙˆØ´Ø´ Ø¶Ø¯ Ø¹Ø±Ù‚", "Ù¾Ù†Ø¨Ù‡ Ø¨Ø§ Ù¾ÙˆØ´Ø´ Ø¶Ø¯ Ù„Ú©Ù‡", "Ù¾Ù†Ø¨Ù‡ Ø¨Ø§ Ù¾ÙˆØ´Ø´ Ø¶Ø¯ Ú†Ø±ÙˆÚ©", "Ù¾Ù†Ø¨Ù‡ Ø®Ø´Ú©â€ŒÚ©Ù† Ø³Ø±ÛŒØ¹", "Ù¾Ù†Ø¨Ù‡ Ø±ÛŒÙ†Ú¯ Ø§Ø³Ù¾Ø§Ù†", "Ù¾Ù†Ø¨Ù‡ Ø´Ø§Ù†Ù‡â€ŒØ®ÙˆØ±Ø¯Ù‡", "Ù¾Ù†Ø¨Ù‡ Ø¶Ø¯ Ø¨Ùˆ", "Ù¾Ù†Ø¨Ù‡ Ø¶Ø¯ Ø­Ø³Ø§Ø³ÛŒØª", "Ù¾Ù†Ø¨Ù‡ Ù…Ø±Ø³Ø±ÛŒØ²Ù‡", "Ù¾Ù†Ø¨Ù‡ Ùˆ ÙˆÛŒØ³Ú©ÙˆØ²", "Ù¾Ù†Ø¨Ù‡ Ùˆ Ù¾Ù„ÛŒâ€ŒØ§Ø³ØªØ±", "Ù¾Ù†Ø¨Ù‡ Ú©Ø§Ù…Ø¨"]
                },
                {
                    "key": "color",
                    "required": false,
                    "type": "select",
                    "value": "",
                    "source": "legacy",
                    "values": ["Ù…Ø´Ú©ÛŒ", "Ø³ÙÛŒØ¯", "Ø®Ø§Ú©Ø³ØªØ±ÛŒ"]
                }
            ]
        };

        function debugWindowData() {
            const output = document.getElementById('debugOutput');
            output.innerHTML = `
                <div class="info"><strong>Window Category Attributes:</strong></div>
                <pre>${JSON.stringify(window.categoryAttributes, null, 2)}</pre>
                <div class="info"><strong>Available Category IDs:</strong> ${Object.keys(window.categoryAttributes).join(', ')}</div>
            `;
        }

        function testLoadAttributes() {
            const categoryId = document.getElementById('categorySelect').value;
            const output = document.getElementById('debugOutput');
            
            if (!categoryId) {
                output.innerHTML = '<div class="error">Please select a category first!</div>';
                return;
            }
            
            output.innerHTML = `<div class="info">Testing loadCategoryAttributes for category ID: ${categoryId}</div>`;
            
            // Simulate the loadCategoryAttributes function logic
            try {
                console.log('ğŸš€ loadCategoryAttributes function called with categoryId:', categoryId);
                
                // ERROR CHECKING
                if (!categoryId) {
                    console.error('âŒ ERROR: categoryId is null/undefined!');
                    output.innerHTML += '<div class="error">âŒ ERROR: categoryId is null/undefined!</div>';
                    return;
                }
                
                if (!window.categoryAttributes) {
                    console.error('âŒ ERROR: window.categoryAttributes is not loaded!');
                    output.innerHTML += '<div class="error">âŒ ERROR: window.categoryAttributes is not loaded!</div>';
                    return;
                }
                
                if (typeof window.categoryAttributes !== 'object') {
                    console.error('âŒ ERROR: window.categoryAttributes is not an object!', typeof window.categoryAttributes);
                    output.innerHTML += '<div class="error">âŒ ERROR: window.categoryAttributes is not an object!</div>';
                    return;
                }
                
                console.log('ğŸ” Available category IDs:', Object.keys(window.categoryAttributes));
                
                // Get category attributes from existing data
                let categoryAttributesData = window.categoryAttributes[categoryId] || window.categoryAttributes[parseInt(categoryId)];
                
                // If still not found, try to find by matching the key
                if (!categoryAttributesData) {
                    console.error('âŒ ERROR: No category attributes found for categoryId:', categoryId);
                    const availableKeys = Object.keys(window.categoryAttributes);
                    console.error('âŒ Available keys:', availableKeys);
                    const matchingKey = availableKeys.find(key => key == categoryId || key == parseInt(categoryId));
                    if (matchingKey) {
                        categoryAttributesData = window.categoryAttributes[matchingKey];
                        console.log('ğŸ”§ Found matching key:', matchingKey);
                    } else {
                        console.error('âŒ ERROR: No matching key found for categoryId:', categoryId);
                        output.innerHTML += '<div class="error">âŒ ERROR: No matching key found for categoryId: ' + categoryId + '</div>';
                        return;
                    }
                }
                
                categoryAttributesData = categoryAttributesData || [];
                console.log('ğŸ”§ Category attributes data:', categoryAttributesData);
                
                // Display the results
                const attributesHtml = categoryAttributesData.map(attr => `
                    <div style="margin: 10px 0; padding: 10px; border: 1px solid #ddd;">
                        <strong>${attr.key}</strong> (${attr.type}) - Required: ${attr.required}<br>
                        Values: ${attr.values.join(', ')}
                    </div>
                `).join('');
                
                output.innerHTML += `
                    <div class="success">âœ… Found ${categoryAttributesData.length} attributes for category ${categoryId}</div>
                    <div id="categoryAttributesData">${attributesHtml}</div>
                `;
                
            } catch (error) {
                console.error('âŒ Error in testLoadAttributes:', error);
                output.innerHTML += '<div class="error">âŒ Error: ' + error.message + '</div>';
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            debugWindowData();
        });
    </script>
</body>
</html>
