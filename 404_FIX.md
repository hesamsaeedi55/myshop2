# 404 Error Fix

## Problem
Getting **404 Not Found** - This means:
- The endpoint exists ‚úÖ
- But the **CartItem** doesn't exist or doesn't belong to the user ‚ùå

## Likely Issue
You're sending the **wrong ID**. Make sure you're using:
- ‚úÖ `item.id` (CartItem ID) 
- ‚ùå NOT `item.product.id` (Product ID)

## Debug Steps

Add this to see what ID you're sending:

```swift
func deleteFromBasket(itemId: Int) async throws -> deleteResponse {
    guard !isLoading else { throw HandlingError.alreadyLoading }
    
    // DEBUG: Print what ID you're sending
    print("üóëÔ∏è Deleting CartItem with ID: \(itemId)")
    
    let urlString = "http://127.0.0.1:8000/shop/api/customer/cart/remove/"
    
    var request = URLRequest(url: URL(string: urlString)!)
    request.setValue("Bearer \(UserDefaults.standard.string(forKey: "accessToken") ?? "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzYyMDk2ODEyLCJpYXQiOjE3NjIwMTA0MTIsImp0aSI6ImMzNTYwZWUzZjgxNTRhOWJhZDM5NmZjNmI0OTg5ZjczIiwidXNlcl9pZCI6MzB9.0jdsCoQesgI4bFlI4VJhhlN3izQomBqAp24innEZI1E")", forHTTPHeaderField: "Authorization")
    request.setValue("application/json", forHTTPHeaderField: "Content-Type")
    request.httpMethod = "DELETE"
    
    let body = ["item_id": itemId]
    request.httpBody = try? JSONSerialization.data(withJSONObject: body)
    
    // DEBUG: Print the body being sent
    if let jsonBody = try? JSONSerialization.data(withJSONObject: body),
       let jsonString = String(data: jsonBody, encoding: .utf8) {
        print("üì§ Request body: \(jsonString)")
    }
    
    do {
        let (data, response) = try await URLSession.shared.data(for: request)
        
        // DEBUG: Print response body
        if let responseString = String(data: data, encoding: .utf8) {
            print("üì• Response body: \(responseString)")
        }
        
        print(response)
        guard let httpResponse = response as? HTTPURLResponse else {
            throw HandlingError.invalidResponse
        }
        
        // DEBUG: Print status code
        print("üìä Status Code: \(httpResponse.statusCode)")
        
        if httpResponse.statusCode == 200 || httpResponse.statusCode == 204 {
            if httpResponse.statusCode == 204 {
                // 204 = No Content, return success
                let successResponse = deleteResponse(success: true, message: "Item deleted")
                Task { await loadShoppingBasket() }
                return successResponse
            }
            
            // 200 = Success with body
            if data.isEmpty {
                let successResponse = deleteResponse(success: true, message: "Item deleted")
                Task { await loadShoppingBasket() }
                return successResponse
            }
            
            let removeResponse = try JSONDecoder().decode(deleteResponse.self, from: data)
            print("‚úÖ product removed from basket: \(removeResponse)")
            Task { await loadShoppingBasket() }
            return removeResponse
        } else {
            // DEBUG: Print error details
            if let errorString = String(data: data, encoding: .utf8) {
                print("‚ùå Error response: \(errorString)")
            }
            throw HandlingError.httpError(httpResponse.statusCode)
        }
    } catch {
        print("‚ùå Exception: \(error)")
        throw HandlingError.networkError(error)
    }
}
```

## Check Your Call Site

Make sure you're calling it with **CartItem ID**, not Product ID:

```swift
// ‚úÖ CORRECT - Using CartItem.id
cartManager.removeFromCart(itemId: item.id)

// ‚ùå WRONG - Using Product.id
cartManager.removeFromCart(itemId: item.product.id)
```

## Verify CartItem Exists

The backend expects:
1. CartItem with `id = item_id` exists
2. CartItem belongs to current user (`cart__customer=request.user`)

If either is false ‚Üí 404

